<!--
 * @Author: ja
 * @Date: 2021-12-28 16:07:50
 * @LastEditors: JA
 * @LastEditTime: 2022-03-27 14:06:37
-->
<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8" />
	<title>Document</title>
</head>

<body>
	<script type="text/javascript">

		let data = {
			name: '尚硅谷',
			address: '北京',
		}

		// const vm = {}
		// const obs = new Observer(data)
		// vm._data = data = obs
		// vm._data.name = 'dasd'
		// console.log(vm._data);
		// console.log(data, 'data');

		// console.log(vm);
		// function Observer(obj) {
		// 	const keys = Object.keys(obj)
		// 	keys.forEach((k) => {
		// 		Object.defineProperty(this, k, {
		// 			get() {
		// 				console.log('get');
		// 				return obj[k]
		// 			},
		// 			set(val) {
		// 				console.log('set');
		// 				obj[k] = val  //data中数据也会改变
		// 			}
		// 		})
		// 	})
		// }

		// //创建一个监视的实例对象，用于监视data中属性的变化
		// const obs = new Observer(data)
		// console.log(obs.name = 2, 'obs');

		// //准备一个vm实例对象
		// let vm = {}
		// vm._data = data =  obs

		// //错误的  会死循环,需要在外部声明value
		Object.defineProperty(data,'name',{
			get(){
				return data.name //一直在访问name 一直调用get 栈溢出
			},
			set(val){
				data.name = val
			}
		})

		console.log(data);

		// function Observer(obj) {
		// 	//汇总对象中所有的属性名形成一个数组
		// 	const keys = Object.keys(obj)
		// 	console.log(keys);
		// 	//遍历
		// 	//foreach方法对数组的每个元素执行一次提供的函数
		// 	keys.forEach((k) => {
		// 		Object.defineProperty(this, k, {
		// 			get() {
		// 				return obj[k]
		// 			},
		// 			set(val) {
		// 				console.log(`${k}被改了，我要去解析模板，生成虚拟DOM.....我要开始忙了`)//${}表示引用值
		// 				obj[k] = val
		// 			}
		// 		})
		// 	})
		// }

		// console.log(vm);


	</script>
</body>

</html>